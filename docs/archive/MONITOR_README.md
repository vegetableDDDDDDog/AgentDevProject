# Linux 系统监控工具使用说明

## 功能特性

这是一个功能强大的 Linux 系统资源监控工具，支持实时监控：

- **CPU 监控**：总体使用率、每个核心使用率、频率、系统负载
- **内存监控**：物理内存、交换分区使用情况
- **磁盘监控**：主要磁盘分区的使用情况（默认过滤 snap 等特殊挂载点）
- **网络监控**：实时上传/下载速度、累计流量、数据包统计
- **进程统计**：当前运行的进程总数

## 使用方法

### 方法 1：在 PyCharm/IDE 中运行（推荐）

直接在 PyCharm 中运行 `linux_monitor.py`，会自动使用**简单模式**（IDE 兼容模式）

### 方法 2：使用启动脚本

```bash
./run_monitor.sh
```

然后选择运行模式：
- 选项 1：简单模式 - 过滤 snap 等挂载点（推荐）
- 选项 2：简单模式 - 显示所有挂载点
- 选项 3：完整模式 - 过滤 snap 等挂载点（推荐）
- 选项 4：完整模式 - 显示所有挂载点
- 选项 5：显示帮助信息

### 方法 3：直接运行 Python 脚本

**默认模式**（自动选择，过滤 snap）：
```bash
python3 linux_monitor.py
```

**简单模式**（适用于 IDE 和不支持 curses 的环境）：
```bash
python3 linux_monitor.py --simple
```

**显示所有磁盘挂载点**（包括 snap）：
```bash
python3 linux_monitor.py --all-disks
```

**组合使用**：
```bash
# 简单模式 + 显示所有挂载点
python3 linux_monitor.py --simple --all-disks
```

**查看帮助信息**：
```bash
python3 linux_monitor.py --help
```

## 命令行参数

| 参数 | 说明 |
|------|------|
| `--simple` | 强制使用简单模式（在 IDE 中自动启用） |
| `--all-disks` | 显示所有磁盘挂载点（包括 snap、/media 等） |
| `-h, --help` | 显示帮助信息 |

## 两种模式的区别

### 简单模式 (--simple)
- ✅ 在 PyCharm 等 IDE 中正常运行
- ✅ 支持 ANSI 颜色代码（彩色输出）
- ✅ 2秒刷新一次
- ✅ 使用 Ctrl+C 退出
- ✅ 显示进度条和彩色高亮

### 完整模式（默认）
- ✅ 需要在独立终端中运行
- ✅ 使用 curses 库，类似 top 命令的界面
- ✅ 1秒刷新一次
- ✅ 按 'q' 键退出
- ✅ 更流畅的实时更新体验

## 磁盘显示说明

### 默认行为（推荐）
工具会自动过滤掉以下挂载点，保持输出简洁：
- **Snap 包**：`/snap/*` （Ubuntu Snap 包，只读文件系统，100% 使用率是正常的）
- **媒体挂载**：`/media/*`、`/mnt/*` （外部设备）
- **特殊文件系统**：`tmpfs`、`proc`、`sysfs`、`debugfs` 等
- **小分区**：小于 100MB 的分区

### 显示所有挂载点
如果需要查看所有挂载点（包括 snap），使用 `--all-disks` 参数：
```bash
python3 linux_monitor.py --all-disks
```

## 退出方式

- **简单模式**：按 `Ctrl+C`
- **完整模式**：按 `q` 键

## 示例输出

```
======================================================================
 Linux 系统监控 - 简单模式
 按 Ctrl+C 退出
======================================================================

时间: 2026-02-04 23:15:30
======================================================================

CPU 使用率:
  总使用率: 40.4% | 核心数: 8 | 频率: 3200 MHz
  每个核心: Core1: 45.2% Core2: 38.1% Core3: 52.3% Core4: 31.5%
  [=========================        ] 40.4%

系统负载:
  1分钟: 1.23 | 5分钟: 1.15 | 15分钟: 1.08

内存使用:
  物理内存: 8.45 GB / 15.53 GB (56.2%)
  [==============================      ] 56.2%
  交换分区: 1.23 GB / 8.00 GB (15.4%)

磁盘使用:
  /          - 45.23 GB / 68.50 GB (68.7%)
  /boot/efi  - 256.00 MB / 512.00 MB (50.0%)

网络统计:
  上传: 1.25 GB (12.45 KB/s) | 下载: 5.67 GB (34.56 KB/s)
  数据包: 发送 1,234,567 | 接收 2,345,678

系统信息:
  运行中的进程数: 234

======================================================================
刷新次数: 15 | 等待下次刷新...
```

## 依赖要求

- Python 3.6+
- psutil 库（已安装）

如果需要重新安装依赖：
```bash
pip3 install psutil
```

## 故障排除

### 问题 1：在 IDE 中运行出现 "nocbreak() returned ERR"
**解决方法**：使用简单模式运行
```bash
python3 linux_monitor.py --simple
```

### 问题 2：显示乱码或颜色不正常
**解决方法**：确保终端支持 ANSI 颜色代码，或使用完整模式在独立终端中运行

### 问题 3：网络速度始终为 0
**解决方法**：这是正常的，需要等待至少两次采样间隔（2秒）才能计算速度

## 技术支持

如有问题，请检查：
1. Python 版本是否为 3.6 或更高
2. psutil 库是否正确安装：`pip3 list | grep psutil`
3. 是否在正确的终端环境中运行
